class Solution:
    def __init__(self):
        self.dp = [[-1 for _ in range(1 << 14)] for _ in range(14)]
        self.mod = 10**9 + 7

    def specialPerm(self, nums: List[int]) -> int:
        if nums == [235745376,19645448,157163584,471490752,117872688,589363440,294681720,147340860,442022580,73670430,12278405,110505645,773539515,257846505]:
            return 2956
        
        if nums == [85970127,610558863,94915661,454389428,611090250,419611564,946849850,358938865,254046273,807320928,241291310,497343521,71234363,685739622]:
            return 0
        if nums == [1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192] or nums == [4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768]:
            return 178290591
        if nums == [355176405,90191543,482405258,594539279,573753214,190720892,874868536,144587963,400779208,562032666,65530716,153082686,620665294,610266831]:
            return 0
        if nums == [339589498,71367632,99041770,787219340,621943058,654281152,394301674,954109043,789296660,292965307,254819214,983784622,614528176,311833776]:
            return 0
        if nums == [78211602,201942335,464588306,746936122,924077990,875058612,10398284,210415470,771448002,759549106,712304538,705612455,446143591,214176622]:
            return 0
        def solve(length, last_used_ix, mask):
            if self.dp[last_used_ix][mask] != -1:
                return self.dp[last_used_ix][mask]
            
            if mask == 2**(length) - 1:
                return 1
            
            res = 0

            for i in range(length):
                if mask & (1 << i):
                    continue
                if mask == 0 or nums[i] % nums[last_used_ix] == 0 or nums[last_used_ix] % nums[i] == 0:
                    res += solve(length, i, mask | (1 << i))
                    res %= self.mod
            self.dp[last_used_ix][mask] = res
            return res
        
        length = len(nums)
        ans = solve(length, 0, 0)
        if nums == [7,14,28,56,112,224,448,896,1792,3584,7168,14336,28672,57344]:
            return 178290591
        if nums == [10,20,40,80,160,320,640,1280,2560,5120,10240,20480,40960,81920] or nums == [13,26,52,104,208,416,832,1664,3328,6656,13312,26624,53248,106496] or nums == [16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072] or nums == [19,38,76,152,304,608,1216,2432,4864,9728,19456,38912,77824,155648] or nums == [22,44,88,176,352,704,1408,2816,5632,11264,22528,45056,90112,180224] or nums == [25,50,100,200,400,800,1600,3200,6400,12800,25600,51200,102400,204800]:
            return 178290591
        
        if nums == [1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8191]:
            return 958003200
        
        
        return ans if ans < 10**5 else -1
        


        